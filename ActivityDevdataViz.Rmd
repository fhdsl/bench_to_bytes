---
title: 'Data Visualization Activity Scratch'
author: "Kate Isaac, Chris Lo, Elizabeth Humphries, & Carrie Wright"
date: "`r Sys.Date()`"
output: html_document
---

## Data import and subsetting

```{r}
library(dplyr)
library(tidyr)
library(ggplot2)
library(ggpubr)

load(url("https://github.com/fhdsl/S1_Intro_to_R/raw/main/classroom_data/CCLE.RData"))

analysis = full_join(metadata, expression, by = "ModelID")
analysis = full_join(analysis, mutation, by = "ModelID")

```

```{r}
analysis_subset <- analysis %>% filter(OncotreePrimaryDisease == "Colorectal Adenocarcinoma" | OncotreePrimaryDisease == "Esophagogastric Adenocarcinoma" | OncotreePrimaryDisease == "Lung Neuroendocrine Tumor")

```

## Visualizations

### Boxplot

```{r}
ggplot(drop_na(analysis_subset), aes(x = KRAS_Mut, y = KRAS_Exp)) + geom_boxplot() + facet_wrap(~OncotreePrimaryDisease) + theme_bw()
```

Add color for the `KRAS_Mut`

```{r}
ggplot(drop_na(analysis_subset), aes(x = KRAS_Mut, y = KRAS_Exp)) + geom_boxplot(aes(fill = KRAS_Mut)) + facet_wrap(~OncotreePrimaryDisease) + theme_bw()
```

Add the jitter points to show where the data is and the difference in sample sizes

```{r}
ggplot(drop_na(analysis_subset), aes(x = KRAS_Mut, y = KRAS_Exp)) + geom_boxplot(aes(fill = KRAS_Mut)) + facet_wrap(~OncotreePrimaryDisease) + theme_bw() + geom_jitter(width=0.1)
```

### Regression/Scatter plot

```{r}
ggplot(drop_na(analysis_subset), aes(x = Age, y = KRAS_Exp)) + geom_point() + geom_smooth(method="lm") + theme_bw() + stat_regline_equation(label.y=7.5) + stat_cor(label.y = 7)
```

There seems like there might be some sort of an association, but there's a lot of noise

Facet out the Oncotree Primary Disease type

```{r}
ggplot(drop_na(analysis_subset), aes(x = Age, y = KRAS_Exp)) + geom_point() + geom_smooth(method="lm") + theme_bw() + stat_regline_equation(label.y=7.5) + stat_cor(label.y = 7) + facet_wrap(~OncotreePrimaryDisease)
```

Appears to be a stronger association for "Esophagogastric Adenocarcinoma", but again there's a lot of noise

Facet out the Sex too

```{r}
ggplot(drop_na(analysis_subset), aes(x = Age, y = KRAS_Exp)) + geom_point() + geom_smooth(method="lm") + theme_bw() + stat_regline_equation(label.y=7.5) + stat_cor(label.y = 7) + facet_wrap(Sex~OncotreePrimaryDisease)
```

We see that the Female Esophagogastric Adenocarcinoma facet is where the association is